
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Mosquitos\_and\_friends}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Import modules and libraries}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{sys}
        \PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/apps}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k+kn}{import} \PY{n+nn}{django}
        \PY{n}{django}\PY{o}{.}\PY{n}{setup}\PY{p}{(}\PY{p}{)}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
\end{Verbatim}


    \section{Mosquitos, the environment and related
species}\label{mosquitos-the-environment-and-related-species}

    

    \subsection{Load Biospytial Modules}\label{load-biospytial-modules}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Import modules}
        \PY{k+kn}{from} \PY{n+nn}{drivers.tree\PYZus{}builder} \PY{k+kn}{import} \PY{n}{TreeNeo}
        \PY{k+kn}{from} \PY{n+nn}{drivers.graph\PYZus{}models} \PY{k+kn}{import} \PY{n}{Order}\PY{p}{,} \PY{n}{Family}\PY{p}{,} \PY{n}{graph}\PY{p}{,} \PY{n}{pickNode}
        \PY{k+kn}{from} \PY{n+nn}{traversals.strategies} \PY{k+kn}{import} \PY{n}{sumTrees}
        \PY{k+kn}{from} \PY{n+nn}{traversals.sampling} \PY{k+kn}{import} \PY{n}{UniformRandomSampleForest}
\end{Verbatim}


    \subsection{LetÂ´s pick the Mosquito
Node}\label{lets-pick-the-mosquito-node}

Remember that Mosquitos are all from the Family \emph{Culicidae} 

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{mosquitos} \PY{o}{=} \PY{n}{pickNode}\PY{p}{(}\PY{n}{Family}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Culicidae}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{o}{\PYZpc{}}\PY{k}{time} cells = list(mosquitos.cells)
         \PY{n}{neighbours} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{cell} \PY{p}{:} \PY{n}{cell}\PY{o}{.}\PY{n}{getNeighbours}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cells}\PY{p}{)}
         \PY{n}{neighbouring\PYZus{}cells} \PY{o}{=} \PY{n+nb}{reduce}\PY{p}{(}\PY{k}{lambda} \PY{n}{a}\PY{p}{,}\PY{n}{b} \PY{p}{:} \PY{n}{a}\PY{o}{+}\PY{n}{b} \PY{p}{,}\PY{n}{neighbours}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}\PYZsh{} Remove repetitions}
         \PY{n}{neighbours} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{neighbouring\PYZus{}cells}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
CPU times: user 1.51 s, sys: 0 ns, total: 1.51 s
Wall time: 2.35 s

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{neighbours}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:} 30
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{c} \PY{o}{=}  \PY{n}{neighbours}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{c}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:} < Cell-mex4km id = 265959 >
\end{Verbatim}
            sample = UniformRandomSampleForest(neighbours,size=5)
%time sample_trees = list(sample)
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{o}{\PYZpc{}}\PY{k}{time} sample\PYZus{}trees = map(lambda cell : TreeNeo(cell.occurrencesHere()),neighbours[:5])
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
CPU times: user 4.4 s, sys: 72 ms, total: 4.47 s
Wall time: 5.61 s

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{sample\PYZus{}trees}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:} [<LocalTree Of Life | Root: LUCA - n.count : 23- >,
          <LocalTree Of Life | Root: LUCA - n.count : 15- >,
          <LocalTree Of Life | Root: LUCA - n.count : 34- >,
          <LocalTree Of Life | Root: LUCA - n.count : 85- >,
          <LocalTree Of Life | Root: LUCA - n.count : 118- >]
\end{Verbatim}
            
    \paragraph{Wait.. wait..}\label{wait..-wait..}

 

    \subsection{Explore the nodes !}\label{explore-the-nodes}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{t1} \PY{o}{=} \PY{n}{sample\PYZus{}trees}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{t1}\PY{o}{.}\PY{n}{to\PYZus{}Animalia}\PY{o}{.}\PY{n}{to\PYZus{}Chordata}\PY{o}{.}\PY{n}{to\PYZus{}Mammalia}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} <LocalTree | Class: Mammalia - n.count : 16- | AF: 0.05 >
\end{Verbatim}
            
    \subsection{By Families, Species, Genera,
etc}\label{by-families-species-genera-etc}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{t1}\PY{o}{.}\PY{n}{phyla}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} [<LocalTree | Phylum: Chordata - n.count : 19- | AF: 0.05 >,
          <LocalTree | Phylum: Arthropoda - n.count : 2- | AF: 0.05 >,
          <LocalTree | Phylum: Magnoliophyta - n.count : 2- | AF: 0.05 >]
\end{Verbatim}
            
    \section{Monoid operations}\label{monoid-operations}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{} Let}
         \PY{n}{t1}\PY{p}{,} \PY{n}{t2} \PY{o}{=} \PY{n}{sample\PYZus{}trees}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{t1}\PY{o}{.}\PY{n}{phyla}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} [<LocalTree | Phylum: Chordata - n.count : 19- | AF: 0.05 >,
          <LocalTree | Phylum: Arthropoda - n.count : 2- | AF: 0.05 >,
          <LocalTree | Phylum: Magnoliophyta - n.count : 2- | AF: 0.05 >]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{t2}\PY{o}{.}\PY{n}{phyla}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} [<LocalTree | Phylum: Chordata - n.count : 13- | AF: 0.05 >,
          <LocalTree | Phylum: Arthropoda - n.count : 1- | AF: 0.05 >,
          <LocalTree | Phylum: Magnoliophyta - n.count : 1- | AF: 0.05 >]
\end{Verbatim}
            
    \subsection{Sum}\label{sum}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{t1} \PY{o}{+} \PY{n}{t2} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO Merging Trees

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} <LocalTree Of Life | Root: LUCA - n.count : 38- >
\end{Verbatim}
            
    \subsubsection{\texorpdfstring{Folding (\emph{Integrate} ) the regional
tree}{Folding (Integrate ) the regional tree}}\label{folding-integrate-the-regional-tree}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{big\PYZus{}t} \PY{o}{=} \PY{n+nb}{reduce}\PY{p}{(}\PY{k}{lambda} \PY{n}{a} \PY{p}{,} \PY{n}{b} \PY{p}{:} \PY{n}{a}\PY{o}{+}\PY{n}{b} \PY{p}{,} \PY{n}{sample\PYZus{}trees}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO Merging Trees
INFO Merging Trees
INFO Merging Trees
INFO Merging Trees

    \end{Verbatim}

    \section{Tree subselections}\label{tree-subselections}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{mammals} \PY{o}{=} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{to\PYZus{}Animalia}\PY{o}{.}\PY{n}{to\PYZus{}Chordata}\PY{o}{.}\PY{n}{to\PYZus{}Mammalia}\PY{o}{.}\PY{n}{plantTreeNode}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{mammals}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} <LocalTree Of Life | Root: LUCA - n.count : 101- >
\end{Verbatim}
            
    \section{Get (Raster) Environmental
Information}\label{get-raster-environmental-information}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{table} \PY{o}{=} \PY{n}{mammals}\PY{o}{.}\PY{n}{associatedData}\PY{o}{.}\PY{n}{getEnvironmentalVariablesPoints}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{table}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}      MaxTemperature\_mean  MaxTemperature\_std  MeanTemperature\_mean  \textbackslash{}
         0              13.916667            4.974239             21.750000   
         1              13.916667            4.974239             21.750000   
         2              13.916667            4.974239             21.750000   
         3              13.916667            4.974239             21.750000   
         4              13.750000            4.866981             21.500000   
         5              13.916667            4.974239             21.750000   
         6              21.583333            0.953794             27.583333   
         7              21.583333            0.953794             27.583333   
         8              21.583333            0.953794             27.583333   
         9              21.583333            0.953794             27.583333   
         10             21.583333            0.953794             27.583333   
         11             21.583333            0.953794             27.583333   
         12             21.583333            0.953794             27.583333   
         13             21.583333            0.953794             27.583333   
         14             21.583333            0.953794             27.583333   
         15             21.583333            0.953794             27.583333   
         16             20.666667            1.795055             25.750000   
         17             20.666667            1.795055             25.750000   
         18             20.666667            1.795055             25.750000   
         19             20.666667            1.795055             25.750000   
         20             20.666667            1.795055             25.750000   
         21             20.666667            1.795055             25.750000   
         22             20.666667            1.795055             25.750000   
         23             20.666667            1.795055             25.750000   
         24             20.666667            1.795055             25.750000   
         25             21.583333            0.953794             27.583333   
         26             21.583333            0.953794             27.583333   
         27             21.583333            0.953794             27.583333   
         28             13.916667            4.974239             21.750000   
         29             13.916667            4.974239             21.750000   
         ..                   {\ldots}                 {\ldots}                   {\ldots}   
         71             13.916667            4.974239             21.750000   
         72             13.916667            4.974239             21.750000   
         73             13.916667            4.974239             21.750000   
         74             13.416667            4.974239             21.166667   
         75             13.416667            4.974239             21.166667   
         76             13.416667            4.974239             21.166667   
         77             13.416667            4.974239             21.166667   
         78             13.916667            4.974239             21.750000   
         79             13.916667            4.974239             21.750000   
         80             13.916667            4.974239             21.750000   
         81             13.916667            4.974239             21.750000   
         82             13.916667            4.974239             21.750000   
         83             13.916667            4.974239             21.750000   
         84             13.916667            4.974239             21.750000   
         85             13.916667            4.974239             21.750000   
         86             13.916667            4.974239             21.750000   
         87             13.916667            4.974239             21.750000   
         88             13.916667            4.974239             21.750000   
         89             13.916667            4.974239             21.750000   
         90             13.916667            4.974239             21.750000   
         91             13.916667            4.974239             21.750000   
         92             13.916667            4.974239             21.750000   
         93             13.916667            4.974239             21.750000   
         94             13.916667            4.974239             21.750000   
         95             13.916667            4.974239             21.750000   
         96             13.916667            4.974239             21.750000   
         97             13.916667            4.974239             21.750000   
         98             13.916667            4.974239             21.750000   
         99             13.916667            4.974239             21.750000   
         100            13.916667            4.974239             21.750000   
         
              MeanTemperature\_std  MinTemperature\_mean  MinTemperature\_std  \textbackslash{}
         0               5.035292            29.416667            5.024247   
         1               5.035292            29.416667            5.024247   
         2               5.035292            29.416667            5.024247   
         3               5.035292            29.416667            5.024247   
         4               5.008326            29.416667            5.024247   
         5               5.035292            29.416667            5.024247   
         6               0.759203            33.666667            0.745356   
         7               0.759203            33.666667            0.745356   
         8               0.759203            33.666667            0.745356   
         9               0.759203            33.666667            0.745356   
         10              0.759203            33.666667            0.745356   
         11              0.759203            33.666667            0.745356   
         12              0.759203            33.666667            0.745356   
         13              0.759203            33.666667            0.745356   
         14              0.759203            33.666667            0.745356   
         15              0.759203            33.666667            0.745356   
         16              1.876388            31.000000            1.732051   
         17              1.876388            31.000000            1.732051   
         18              1.876388            31.000000            1.732051   
         19              1.876388            31.000000            1.732051   
         20              1.876388            31.000000            1.732051   
         21              1.876388            31.000000            1.732051   
         22              1.876388            31.000000            1.732051   
         23              1.876388            31.000000            1.732051   
         24              1.876388            31.000000            1.732051   
         25              0.759203            33.666667            0.745356   
         26              0.759203            33.666667            0.745356   
         27              0.759203            33.666667            0.745356   
         28              5.035292            29.416667            5.024247   
         29              5.035292            29.416667            5.024247   
         ..                   {\ldots}                  {\ldots}                 {\ldots}   
         71              5.035292            29.416667            5.024247   
         72              5.035292            29.416667            5.024247   
         73              5.035292            29.416667            5.024247   
         74              4.997221            29.333333            5.005552   
         75              4.997221            29.333333            5.005552   
         76              4.997221            29.333333            5.005552   
         77              4.997221            29.333333            5.005552   
         78              5.035292            29.416667            5.024247   
         79              5.035292            29.416667            5.024247   
         80              5.035292            29.416667            5.024247   
         81              5.035292            29.416667            5.024247   
         82              5.035292            29.416667            5.024247   
         83              5.035292            29.416667            5.024247   
         84              5.035292            29.416667            5.024247   
         85              5.035292            29.416667            5.024247   
         86              5.035292            29.500000            5.123475   
         87              5.035292            29.416667            5.024247   
         88              5.035292            29.416667            5.024247   
         89              5.035292            29.416667            5.024247   
         90              5.035292            29.416667            5.024247   
         91              5.035292            29.416667            5.024247   
         92              5.035292            29.416667            5.024247   
         93              5.035292            29.416667            5.024247   
         94              5.035292            29.416667            5.024247   
         95              5.035292            29.416667            5.024247   
         96              5.035292            29.416667            5.024247   
         97              5.035292            29.416667            5.024247   
         98              5.035292            29.416667            5.024247   
         99              5.035292            29.416667            5.024247   
         100             5.035292            29.416667            5.024247   
         
              Precipitation\_mean  Precipitation\_std  Vapor\_mean  Vapor\_std  \textbackslash{}
         0             20.166667          15.203253    1.333333   0.471405   
         1             20.166667          15.203253    1.333333   0.471405   
         2             20.166667          15.203253    1.333333   0.471405   
         3             20.166667          15.203253    1.333333   0.471405   
         4             20.833333          15.715350    1.333333   0.471405   
         5             20.166667          15.203253    1.333333   0.471405   
         6            208.000000         174.915218    2.666667   0.471405   
         7            208.000000         174.915218    2.666667   0.471405   
         8            208.000000         174.915218    2.666667   0.471405   
         9            208.000000         174.915218    2.666667   0.471405   
         10           208.000000         174.915218    2.666667   0.471405   
         11           208.000000         174.915218    2.666667   0.471405   
         12           208.000000         174.915218    2.666667   0.471405   
         13           208.000000         174.915218    2.666667   0.471405   
         14           208.000000         174.915218    2.666667   0.471405   
         15           208.000000         174.915218    2.666667   0.471405   
         16            71.500000          36.602596    2.500000   0.500000   
         17            71.500000          36.602596    2.500000   0.500000   
         18            71.500000          36.602596    2.500000   0.500000   
         19            71.500000          36.602596    2.500000   0.500000   
         20            71.500000          36.602596    2.500000   0.500000   
         21            71.500000          36.602596    2.500000   0.500000   
         22            71.500000          36.602596    2.500000   0.500000   
         23            71.500000          36.602596    2.500000   0.500000   
         24            71.500000          36.602596    2.500000   0.500000   
         25           208.000000         174.915218    2.666667   0.471405   
         26           208.000000         174.915218    2.666667   0.471405   
         27           208.000000         174.915218    2.666667   0.471405   
         28            20.166667          15.203253    1.333333   0.471405   
         29            20.166667          15.203253    1.333333   0.471405   
         ..                  {\ldots}                {\ldots}         {\ldots}        {\ldots}   
         71            20.166667          15.203253    1.333333   0.471405   
         72            20.166667          15.203253    1.333333   0.471405   
         73            20.166667          15.203253    1.333333   0.471405   
         74            21.166667          16.481471    1.333333   0.471405   
         75            21.166667          16.481471    1.333333   0.471405   
         76            21.166667          16.481471    1.333333   0.471405   
         77            21.166667          16.481471    1.333333   0.471405   
         78            20.166667          15.203253    1.333333   0.471405   
         79            20.166667          15.203253    1.333333   0.471405   
         80            20.166667          15.203253    1.333333   0.471405   
         81            20.166667          15.203253    1.333333   0.471405   
         82            20.166667          15.203253    1.333333   0.471405   
         83            20.166667          15.203253    1.333333   0.471405   
         84            20.166667          15.203253    1.333333   0.471405   
         85            20.166667          15.203253    1.333333   0.471405   
         86            20.000000          13.904436    1.333333   0.471405   
         87            20.083333          14.038390    1.333333   0.471405   
         88            20.083333          14.038390    1.333333   0.471405   
         89            20.083333          14.038390    1.333333   0.471405   
         90            20.083333          14.038390    1.333333   0.471405   
         91            20.083333          14.038390    1.333333   0.471405   
         92            20.083333          14.038390    1.333333   0.471405   
         93            20.083333          14.038390    1.333333   0.471405   
         94            20.083333          14.038390    1.333333   0.471405   
         95            20.083333          14.038390    1.333333   0.471405   
         96            20.083333          14.038390    1.333333   0.471405   
         97            20.083333          14.038390    1.333333   0.471405   
         98            20.083333          14.038390    1.333333   0.471405   
         99            20.250000          14.248538    1.333333   0.471405   
         100           20.250000          14.248538    1.333333   0.471405   
         
              SolarRadiation\_mean  SolarRadiation\_std  WindSpeed\_mean  WindSpeed\_std  \textbackslash{}
         0           16683.000000         3419.142266        2.333333       0.471405   
         1           16683.000000         3419.142266        2.333333       0.471405   
         2           16683.000000         3419.142266        2.333333       0.471405   
         3           16683.000000         3419.142266        2.333333       0.471405   
         4           16706.916667         3430.710117        2.333333       0.471405   
         5           16683.000000         3419.142266        2.333333       0.471405   
         6           18249.083333         1151.947153        2.250000       0.433013   
         7           18249.083333         1151.947153        2.250000       0.433013   
         8           18249.083333         1151.947153        2.250000       0.433013   
         9           18249.083333         1151.947153        2.250000       0.433013   
         10          18249.083333         1151.947153        2.250000       0.433013   
         11          18249.083333         1151.947153        2.250000       0.433013   
         12          18249.083333         1151.947153        2.250000       0.433013   
         13          18249.083333         1151.947153        2.250000       0.433013   
         14          18249.083333         1151.947153        2.250000       0.433013   
         15          18249.083333         1151.947153        2.250000       0.433013   
         16          18203.083333         2893.894275        3.500000       0.500000   
         17          18203.083333         2893.894275        3.500000       0.500000   
         18          18203.083333         2893.894275        3.500000       0.500000   
         19          18203.083333         2893.894275        3.500000       0.500000   
         20          18203.083333         2893.894275        3.500000       0.500000   
         21          18203.083333         2893.894275        3.500000       0.500000   
         22          18203.083333         2893.894275        3.500000       0.500000   
         23          18203.083333         2893.894275        3.500000       0.500000   
         24          18203.083333         2893.894275        3.500000       0.500000   
         25          18249.083333         1151.947153        2.250000       0.433013   
         26          18249.083333         1151.947153        2.250000       0.433013   
         27          18249.083333         1151.947153        2.250000       0.433013   
         28          16683.000000         3419.142266        2.333333       0.471405   
         29          16683.000000         3419.142266        2.333333       0.471405   
         ..                   {\ldots}                 {\ldots}             {\ldots}            {\ldots}   
         71          16683.000000         3419.142266        2.333333       0.471405   
         72          16683.000000         3419.142266        2.333333       0.471405   
         73          16683.000000         3419.142266        2.333333       0.471405   
         74          16708.916667         3412.480316        2.416667       0.493007   
         75          16708.916667         3412.480316        2.416667       0.493007   
         76          16708.916667         3412.480316        2.416667       0.493007   
         77          16708.916667         3412.480316        2.416667       0.493007   
         78          16683.000000         3419.142266        2.333333       0.471405   
         79          16683.000000         3419.142266        2.333333       0.471405   
         80          16683.000000         3419.142266        2.333333       0.471405   
         81          16683.000000         3419.142266        2.333333       0.471405   
         82          16683.000000         3419.142266        2.333333       0.471405   
         83          16683.000000         3419.142266        2.333333       0.471405   
         84          16683.000000         3419.142266        2.333333       0.471405   
         85          16683.000000         3419.142266        2.333333       0.471405   
         86          16033.083333         2955.107005        2.333333       0.471405   
         87          16079.083333         2961.077716        2.333333       0.471405   
         88          16079.083333         2961.077716        2.333333       0.471405   
         89          16079.083333         2961.077716        2.333333       0.471405   
         90          16079.083333         2961.077716        2.333333       0.471405   
         91          16079.083333         2961.077716        2.333333       0.471405   
         92          16079.083333         2961.077716        2.333333       0.471405   
         93          16079.083333         2961.077716        2.333333       0.471405   
         94          16079.083333         2961.077716        2.333333       0.471405   
         95          16079.083333         2961.077716        2.333333       0.471405   
         96          16079.083333         2961.077716        2.333333       0.471405   
         97          16079.083333         2961.077716        2.333333       0.471405   
         98          16079.083333         2961.077716        2.333333       0.471405   
         99          16110.416667         2993.848651        2.333333       0.471405   
         100         16110.416667         2993.848651        2.333333       0.471405   
         
                      x         y  
         0   -103.42000  25.51000  
         1   -103.42000  25.51000  
         2   -103.42000  25.51000  
         3   -103.42000  25.51000  
         4   -103.44000  25.51000  
         5   -103.42000  25.51000  
         6    -92.23900  14.85800  
         7    -92.23900  14.85800  
         8    -92.23900  14.85800  
         9    -92.23900  14.85800  
         10   -92.23900  14.85800  
         11   -92.23900  14.85800  
         12   -92.23900  14.85800  
         13   -92.23900  14.85800  
         14   -92.23900  14.85800  
         15   -92.23900  14.85800  
         16   -87.65900  21.47200  
         17   -87.65900  21.47200  
         18   -87.65900  21.47200  
         19   -87.65900  21.47200  
         20   -87.65900  21.47200  
         21   -87.65900  21.47200  
         22   -87.65900  21.47200  
         23   -87.65900  21.47200  
         24   -87.65900  21.47200  
         25   -92.24000  14.85300  
         26   -92.23900  14.85800  
         27   -92.23900  14.85800  
         28  -103.42000  25.51000  
         29  -103.42000  25.51000  
         ..         {\ldots}       {\ldots}  
         71  -103.42000  25.51000  
         72  -103.42000  25.51000  
         73  -103.42000  25.51000  
         74  -103.46900  25.52500  
         75  -103.46944  25.52500  
         76  -103.46944  25.52500  
         77  -103.46900  25.52500  
         78  -103.42000  25.51000  
         79  -103.42000  25.51000  
         80  -103.42000  25.51000  
         81  -103.42000  25.51000  
         82  -103.42000  25.51000  
         83  -103.42000  25.51000  
         84  -103.42000  25.51000  
         85  -103.42000  25.51000  
         86  -103.41257  25.54444  
         87  -103.42000  25.54000  
         88  -103.42000  25.54000  
         89  -103.42000  25.54000  
         90  -103.42000  25.54000  
         91  -103.42000  25.54000  
         92  -103.42000  25.54000  
         93  -103.42000  25.54000  
         94  -103.42000  25.54000  
         95  -103.42000  25.54000  
         96  -103.42000  25.54000  
         97  -103.42000  25.54000  
         98  -103.42000  25.54000  
         99  -103.44167  25.54444  
         100 -103.44167  25.54444  
         
         [101 rows x 16 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{t1}\PY{o}{.}\PY{n}{associatedData}\PY{o}{.}\PY{n}{getAssociatedRasterAreaData}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MeanTemperature}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{display\PYZus{}field}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_35_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Explore array with numpy}\label{explore-array-with-numpy}

    \section{Rank co-occurrent Nodes}\label{rank-co-occurrent-nodes}

    For this we will calculate the frequency of each Node in the big tree,
using another list of trees. In this case the sample of trees that we've
got.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{countNodesFrequenciesOnList}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}trees}\PY{o}{=}\PY{n}{sample\PYZus{}trees}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.6
INFO Going deep 0.6
INFO Going deep 0.6
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.6
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.6
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.6
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.8
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.6
INFO Going deep 0.6
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.8
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.6
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.8
INFO Going deep 1.0
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.8
INFO Going deep 1.0
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.6
INFO Going deep 0.6
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.4
INFO Going deep 0.8
INFO Going deep 1.0
INFO Going deep 1.0

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} 0.05
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{rankLevels}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO Sorting nodes in taxonomic levels by counts on frequencies

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} True
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{families}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:} [<LocalTree | Family: Picidae - n.count : 6- | AF: 0.6 >,
          <LocalTree | Family: Parulidae - n.count : 17- | AF: 0.6 >,
          <LocalTree | Family: Icteridae - n.count : 14- | AF: 0.6 >,
          <LocalTree | Family: Fabaceae - n.count : 5- | AF: 0.6 >,
          <LocalTree | Family: Columbidae - n.count : 21- | AF: 0.6 >]
\end{Verbatim}
            
    \subsubsection{And for mammals ?}\label{and-for-mammals}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{mammals}\PY{o}{.}\PY{n}{countNodesFrequenciesOnList}\PY{p}{(}\PY{n}{sample\PYZus{}trees}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.6
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.2
INFO Going deep 0.4
INFO Going deep 0.8
INFO Going deep 1.0
INFO Going deep 1.0

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}27}]:} 0.05
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{mammals}\PY{o}{.}\PY{n}{rankLevels}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
INFO Sorting nodes in taxonomic levels by counts on frequencies

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:} True
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{mammals}\PY{o}{.}\PY{n}{orders}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:} [<LocalTree | Order: Chiroptera - n.count : 27- | AF: 0.6 >,
          <LocalTree | Order: Rodentia - n.count : 67- | AF: 0.4 >,
          <LocalTree | Order: Carnivora - n.count : 6- | AF: 0.2 >,
          <LocalTree | Order: Lagomorpha - n.count : 1- | AF: 0.2 >]
\end{Verbatim}
            
    \section{Graph analytics}\label{graph-analytics}

    \subsection{Convert the TreeNeo object to a Network instance
(networkx)}\label{convert-the-treeneo-object-to-a-network-instance-networkx}

\subsubsection{The depth\_level restricts the depth of the recursion
process.}\label{the-depth_level-restricts-the-depth-of-the-recursion-process.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{gt} \PY{o}{=} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{toNetworkx}\PY{p}{(}\PY{n}{depth\PYZus{}level}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Plot the Tree}
         \PY{k+kn}{from} \PY{n+nn}{drivers.tools} \PY{k+kn}{import} \PY{n}{plotTree}
         \PY{n}{x} \PY{o}{=} \PY{n}{plotTree}\PY{p}{(}\PY{n}{big\PYZus{}t}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Standard Graph analysis}\label{standard-graph-analysis}

With the \textbf{networkx} library

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{k+kn}{import} \PY{n+nn}{networkx} \PY{k+kn}{as} \PY{n+nn}{nt}
         \PY{n}{lap} \PY{o}{=}\PY{n}{nt}\PY{o}{.}\PY{n}{laplacian\PYZus{}matrix}\PY{p}{(}\PY{n}{gt}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{sp} \PY{o}{=} \PY{n}{nt}\PY{o}{.}\PY{n}{laplacian\PYZus{}spectrum}\PY{p}{(}\PY{n}{gt}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{sp}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}34}]:} (474,)
\end{Verbatim}
            
    \subsection{Distance to species}\label{distance-to-species}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{k+kn}{from} \PY{n+nn}{drivers.graph\PYZus{}models} \PY{k+kn}{import} \PY{n}{Root}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{ss} \PY{o}{=} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{species}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{species} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{l} \PY{p}{:} \PY{n}{l}\PY{o}{.}\PY{n}{node} \PY{p}{,} \PY{n+nb}{list}\PY{p}{(}\PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{species}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{n}{pairs} \PY{o}{=} \PY{p}{[}\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)} \PY{k}{for} \PY{n}{a} \PY{o+ow}{in} \PY{n}{species} \PY{k}{for} \PY{n}{b} \PY{o+ow}{in} \PY{n}{species}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Taxonomic distance doesn\PYZsq{}t use information of the graph restricted to the location. }
         \PY{c+c1}{\PYZsh{}\PYZsh{}Only to the taxonomic structure}
         \PY{n}{dist} \PY{o}{=} \PY{k}{lambda} \PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)} \PY{p}{:} \PY{n}{a}\PY{o}{.}\PY{n}{taxonomicDistanceTo}\PY{p}{(}\PY{n}{b}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{o}{\PYZpc{}}\PY{k}{time} distancias = map(dist,pairs)
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
CPU times: user 1min 9s, sys: 12 ms, total: 1min 9s
Wall time: 1min 9s

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{distancias} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{distancias}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{genera}\PY{p}{)}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{genera}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{distancias}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Reds}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}78}]:} <matplotlib.colorbar.Colorbar at 0x7f0c65944350>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_62_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    I need to replace the root node because is treeneo and it should be
localtree After this we will have the shortestpath with attribute
n\_presences list guaja guaajajajajaj!!!

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{n}{lynx} \PY{o}{=} \PY{k}{lambda} \PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)} \PY{p}{:} \PY{n}{a}\PY{o}{.}\PY{n}{mergeLinageWithNode}\PY{p}{(}\PY{n}{b}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{o}{\PYZpc{}}\PY{k}{time} linages = map(lynx,pairs)
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
CPU times: user 1min, sys: 344 ms, total: 1min
Wall time: 1min

    \end{Verbatim}

    \subsection{Here we will use the general graph to extract shortest paths
and
attributes.}\label{here-we-will-use-the-general-graph-to-extract-shortest-paths-and-attributes.}

The attributes extracted are related to the geographical context and
therefore they are defined in the LocalTree class which extends the
TreeNode class (is a super class of LocalTree). When the graph is built
'gt'

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} With the graph object}
         \PY{n}{pathsf} \PY{o}{=} \PY{k}{lambda} \PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)} \PY{p}{:} \PY{n}{nt}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{gt}\PY{p}{,}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)}
         \PY{o}{\PYZpc{}}\PY{k}{time} paths = map(pathsf,pairs)
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
CPU times: user 55.5 s, sys: 16 ms, total: 55.5 s
Wall time: 55.6 s

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{paths}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{n}{linages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}83}]:} False
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{nt}\PY{o}{.}\PY{n}{draw}\PY{p}{(}\PY{n}{linages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_69_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{ppp1} \PY{o}{=} \PY{n}{nt}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{linages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{pairs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{pairs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{ppp1} \PY{o}{==} \PY{n}{paths}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}86}]:} True
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{paths}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}87}]:} [<TreeNode type: Specie id = 2478081 name: Melanerpes aurifrons (Wagler, 1829)>,
          <TreeNode type: Genus id = 2478067 name: Melanerpes>,
          <TreeNode type: Family id = 9333 name: Picidae>,
          <TreeNode type: Order id = 724 name: Piciformes>,
          <TreeNode type: Class id = 212 name: Aves>,
          <TreeNode type: Phylum id = 44 name: Chordata>,
          <TreeNode type: Kingdom id = 1 name: Animalia>,
          <TreeNode type: Phylum id = 54 name: Arthropoda>,
          <TreeNode type: Class id = 281 name: Branchiopoda>,
          <TreeNode type: Order id = 1159 name: Notostraca>,
          <TreeNode type: Family id = 2235047 name: Triopsidae>,
          <TreeNode type: Genus id = 2235057 name: Triops>,
          <TreeNode type: Specie id = 2235060 name: Triops longicaudatus (LeConte, 1846)>]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{n}{freqs} \PY{o}{=} \PY{n}{nt}\PY{o}{.}\PY{n}{get\PYZus{}node\PYZus{}attributes}\PY{p}{(}\PY{n}{gt}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{richness} \PY{o}{=} \PY{n}{nt}\PY{o}{.}\PY{n}{get\PYZus{}node\PYZus{}attributes}\PY{p}{(}\PY{n}{gt}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{richness}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{level}  \PY{o}{=} \PY{n}{nt}\PY{o}{.}\PY{n}{get\PYZus{}node\PYZus{}attributes}\PY{p}{(}\PY{n}{gt}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{level}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}155}]:} \PY{k}{def} \PY{n+nf}{modifiedDistance}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
              \PY{n}{extractFreqsFromPath} \PY{o}{=} \PY{k}{lambda} \PY{n}{path} \PY{p}{:} \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{node} \PY{p}{:} \PY{n}{freqs}\PY{p}{[}\PY{n}{node}\PY{p}{]}\PY{p}{,}\PY{n}{path}\PY{p}{)}
              \PY{n}{extractRichnessFromPath} \PY{o}{=} \PY{k}{lambda} \PY{n}{path} \PY{p}{:} \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{node} \PY{p}{:} \PY{n}{richness}\PY{p}{[}\PY{n}{node}\PY{p}{]}\PY{p}{,}\PY{n}{path}\PY{p}{)}
              \PY{n}{extractLevelFromPath} \PY{o}{=} \PY{k}{lambda} \PY{n}{path} \PY{p}{:} \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{node} \PY{p}{:} \PY{n}{level}\PY{p}{[}\PY{n}{node}\PY{p}{]}\PY{p}{,}\PY{n}{path}\PY{p}{)}
              \PY{n}{dat} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freq}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{n}{extractFreqsFromPath}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rich}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{extractRichnessFromPath}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{level}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{extractLevelFromPath}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}
              \PY{n}{dat}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{level}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{dat}\PY{o}{.}\PY{n}{level} \PY{o}{+} \PY{l+m+mi}{1}
              \PY{n}{dat}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fl}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{dat}\PY{o}{.}\PY{n}{freq} \PY{o}{/} \PY{n}{dat}\PY{o}{.}\PY{n}{level}
              
              \PY{k}{return} \PY{n}{dat}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}156}]:} \PY{n}{test1} \PY{o}{=} \PY{n}{modifiedDistance}\PY{p}{(}\PY{n}{pp1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}157}]:} \PY{o}{\PYZpc{}}\PY{k}{time} distances\PYZus{}m = map(lambda path : modifiedDistance(path),paths)
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
CPU times: user 1min 20s, sys: 24 ms, total: 1min 20s
Wall time: 1min 20s

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}158}]:} \PY{n}{distances\PYZus{}m} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{distances\PYZus{}m}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}159}]:} \PY{n}{n} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{species}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}164}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{distances\PYZus{}m}\PY{o}{.}\PY{n}{freq}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{n}\PY{p}{,}\PY{n}{n}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}164}]:} <matplotlib.colorbar.Colorbar at 0x7f0c45ecddd0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_79_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}161}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{distances\PYZus{}m}\PY{o}{.}\PY{n}{rich}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{n}\PY{p}{,}\PY{n}{n}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}161}]:} <matplotlib.image.AxesImage at 0x7f0c4cd34810>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}162}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{distances\PYZus{}m}\PY{o}{.}\PY{n}{level}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{n}\PY{p}{,}\PY{n}{n}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}162}]:} <matplotlib.image.AxesImage at 0x7f0c45a1a110>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_81_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}163}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{distances\PYZus{}m}\PY{o}{.}\PY{n}{fl}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{n}\PY{p}{,}\PY{n}{n}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}163}]:} <matplotlib.image.AxesImage at 0x7f0c45cf5650>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_82_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{n} \PY{p}{:} \PY{n}{freqs}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{,}\PY{n}{pp1}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}91}]:} [0.6, 0.6, 0.6, 0.6, 0.8, 1.0, 1.0, 0.8, 0.4, 0.4, 0.4, 0.4, 0.4]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{p0}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}dict\PYZus{}\PYZus{}}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}71}]:} \{'\_GraphObject\_\_ogm': <py2neo.ogm.OGM at 0x7f0c68bda190>\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{nn1} \PY{o}{=} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{species}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{l1}\PY{o}{.}\PY{n}{edges}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{from} \PY{n+nn}{drivers.tree\PYZus{}builder} \PY{k+kn}{import} \PY{n}{LocalTree}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{node}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{node}\PY{p}{,}\PY{n}{TreeNeo}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{ed1} \PY{o}{=} \PY{n}{gt}\PY{o}{.}\PY{n}{edges}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} nt.Graph.add\PYZus{}edge\PY{o}{?}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{nt}\PY{o}{.}\PY{n}{Graph}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{add\PYZus{}edge}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{dist2} \PY{o}{=} \PY{k}{lambda} \PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)} \PY{p}{:} \PY{n}{nt}\PY{o}{.}\PY{n}{shortest\PYZus{}path\PYZus{}length}\PY{p}{(}\PY{n}{gt}\PY{p}{,}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{,}\PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}}\PY{k}{time} distancias = map(dist2,pairs)
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{distancias} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{distancias}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{genera}\PY{p}{)}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{genera}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{distancias}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Reds}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{nodes} \PY{o}{=} \PY{n}{gt}\PY{o}{.}\PY{n}{nodes}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{from} \PY{n+nn}{drivers.graph\PYZus{}models} \PY{k+kn}{import} \PY{n}{TreeNode}
        \PY{n}{root} \PY{o}{=} \PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{a} \PY{p}{:} \PY{o+ow}{not} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{TreeNode}\PY{p}{)}\PY{p}{,}\PY{n}{nodes}\PY{p}{)}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{gt}\PY{o}{.}\PY{n}{remove\PYZus{}node}\PY{p}{(}\PY{n}{root}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{nt}\PY{o}{.}\PY{n}{get\PYZus{}edge\PYZus{}attributes}\PY{p}{(}\PY{n}{gt}\PY{p}{,}\PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{freq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{node}\PY{o}{.}\PY{n}{node}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{distancias} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{distancias}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{genera}\PY{p}{)}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{genera}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{distancias}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{g}\PY{o}{.}\PY{n}{node}\PY{o}{.}\PY{n}{ta}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{g} \PY{o}{=} \PY{n}{genera}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{n}{dist} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{node} \PY{o+ow}{in} \PY{n}{genera}\PY{p}{:}
            \PY{k}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{calculating distance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{o}{\PYZpc{}}\PY{k}{time} dist.append(node.mergeLinageWithNode(g))
            
        \PY{c+c1}{\PYZsh{}cosas = map(lambda n : g.taxonomicDistanceTo(n),genera)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{distances} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{specie} \PY{o+ow}{in} \PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{species}\PY{p}{:}
            \PY{n}{distances}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{sp} \PY{p}{:} \PY{n}{specie}\PY{o}{.}\PY{n}{node}\PY{o}{.}\PY{n}{taxonomicDistanceTo}\PY{p}{(}\PY{n}{sp}\PY{o}{.}\PY{n}{node}\PY{p}{)}\PY{p}{,}\PY{n}{big\PYZus{}t}\PY{o}{.}\PY{n}{species}\PY{p}{)}\PY{p}{)}
            
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
        \PY{n}{sp\PYZus{}dist\PYZus{}table} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{distances}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Export to R}
        \PY{n}{x} \PY{o}{=} \PY{n}{table}\PY{o}{.}\PY{n}{to\PYZus{}json}\PY{p}{(}\PY{p}{)}
        \PY{k+kn}{from} \PY{n+nn}{drivers.tools} \PY{k+kn}{import} \PY{n}{redisConnection} \PY{k}{as} \PY{n}{rc}
        \PY{n}{r} \PY{o}{=} \PY{n}{rc}\PY{p}{(}\PY{p}{)}
        \PY{n}{r}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spatstats2017}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{x}\PY{p}{)}
        \PY{n}{r}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
